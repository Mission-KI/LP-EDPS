{%- import "utils.html.jinja" as utils -%}
{%- import "ds_archive.html.jinja" as ds_archive -%}
{%- import "ds_document.html.jinja" as ds_document -%}
{%- import "ds_image.html.jinja" as ds_image -%}
{%- import "ds_semistructured.html.jinja" as ds_semistructured -%}
{%- import "ds_structured.html.jinja" as ds_structured -%}
{%- import "ds_unstructured.html.jinja" as ds_unstructured -%}
{%- import "ds_video.html.jinja" as ds_video -%}

<!DOCTYPE html>
<html>
    {% include "styles.html.jinja" %}

    <body>
        <h1>EDP report for {{edp.name}}</h1>

        {% set asset_ref = edp.assetRefs[0] %}
        {{ 
            utils.print_key_value_table([
                ("Title", edp.name), 
                ("Description", edp.description), 
                ("Publisher", asset_ref.publisher.name), 
                ("Publisher URL", asset_ref.publisher.url),
                ("Publishing date", utils.format_datetime(asset_ref.publishDate)),
                ("License", utils.join([asset_ref.license.name, asset_ref.license.url])), 
                ("Tags", utils.join(edp.tags)), 
                ("EDP creation date", utils.format_datetime(currentDate)), 
                ("EDP generated by", edp.generatedBy),
                ("EDP version", edp.schemaVersion),
            ])
        }}

        {% for ds in datasets %}
            <h2>Dataset {{ds.qualifiedName}}</h2>

            {% if ds.details is type_ArchiveDataSet %}
                {{ ds_archive.print(ds) }}

            {% elif ds.details is type_StructuredDataset %}
                {{ ds_structured.print(ds) }}

            {% elif ds.details is type_SemiStructuredDataSet %}
                {{ ds_semistructured.print(ds) }}

            {% elif ds.details is type_UnstructuredTextDataSet %}
                {{ ds_unstructured.print(ds) }}

            {% elif ds.details is type_DocumentDataSet %}
                {{ ds_document.print(ds) }}

            {% elif ds.details is type_ImageDataSet %}
                {{ ds_image.print(ds) }}

            {% elif ds.details is type_VideoDataSet %}
                {{ ds_video.print(ds) }}

            {% else %}
                <div>Unsupported dataset type</div>
            {% endif %}
        {% endfor %}

        <p>
            Created with {{edp.generatedBy}}
            <br/>
            &copy; 2025 beebucket GmbH (<a href="http://www.beebucket.de">www.beebucket.de</a>)
        </p>

        {# <hr/>        
        <pre>{% debug %}</pre> #}
    </body>
</html>
